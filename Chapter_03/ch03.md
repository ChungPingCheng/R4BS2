第三章: 變項間關係
================

# 資料與管理

``` r
#讀檔案，資料來自於 TIMSS 2011 年
dta <- read.csv(file = "../Data/TIMSS3C.csv", 
                  header = TRUE, stringsAsFactors = TRUE)
```

``` r
#檢視資料結構
#程式報表3.1
str(dta)
```

    'data.frame':   12300 obs. of  9 variables:
     $ 國家    : Factor w/ 3 levels "日本","台灣",..: 2 2 2 2 2 2 2 2 2 2 ...
     $ 性別    : Factor w/ 2 levels "女生","男生": 1 1 1 1 1 1 1 1 1 1 ...
     $ 父母教育: Factor w/ 5 levels "大學以上","初中",..: 3 3 4 2 1 5 3 1 2 3 ...
     $ 數學    : num  729 776 718 607 658 ...
     $ 化學    : num  625 662 709 633 618 ...
     $ 地科    : num  608 666 629 620 614 ...
     $ 生物    : num  651 628 617 592 560 ...
     $ 物理    : num  618 617 663 616 591 ...
     $ 電腦    : Factor w/ 2 levels "有","無": 1 1 1 1 1 1 1 1 1 1 ...

``` r
#看看前六筆
#程式報表3.2
head(dta)
```

<table>
<thead>
<tr>
<th style="text-align:left;">
國家
</th>
<th style="text-align:left;">
性別
</th>
<th style="text-align:left;">
父母教育
</th>
<th style="text-align:right;">
數學
</th>
<th style="text-align:right;">
化學
</th>
<th style="text-align:right;">
地科
</th>
<th style="text-align:right;">
生物
</th>
<th style="text-align:right;">
物理
</th>
<th style="text-align:left;">
電腦
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:left;">
高中
</td>
<td style="text-align:right;">
729.4
</td>
<td style="text-align:right;">
624.8
</td>
<td style="text-align:right;">
607.8
</td>
<td style="text-align:right;">
650.7
</td>
<td style="text-align:right;">
618.3
</td>
<td style="text-align:left;">
有
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:left;">
高中
</td>
<td style="text-align:right;">
776.2
</td>
<td style="text-align:right;">
661.8
</td>
<td style="text-align:right;">
665.7
</td>
<td style="text-align:right;">
627.9
</td>
<td style="text-align:right;">
616.7
</td>
<td style="text-align:left;">
有
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:left;">
國小以下
</td>
<td style="text-align:right;">
718.2
</td>
<td style="text-align:right;">
708.8
</td>
<td style="text-align:right;">
629.3
</td>
<td style="text-align:right;">
617.5
</td>
<td style="text-align:right;">
663.3
</td>
<td style="text-align:left;">
有
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:left;">
初中
</td>
<td style="text-align:right;">
607.2
</td>
<td style="text-align:right;">
633.0
</td>
<td style="text-align:right;">
620.3
</td>
<td style="text-align:right;">
592.1
</td>
<td style="text-align:right;">
616.5
</td>
<td style="text-align:left;">
有
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:left;">
大學以上
</td>
<td style="text-align:right;">
658.2
</td>
<td style="text-align:right;">
617.8
</td>
<td style="text-align:right;">
614.1
</td>
<td style="text-align:right;">
560.2
</td>
<td style="text-align:right;">
591.0
</td>
<td style="text-align:left;">
有
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:left;">
專科
</td>
<td style="text-align:right;">
478.6
</td>
<td style="text-align:right;">
601.2
</td>
<td style="text-align:right;">
591.0
</td>
<td style="text-align:right;">
598.8
</td>
<td style="text-align:right;">
554.0
</td>
<td style="text-align:left;">
有
</td>
</tr>
</tbody>
</table>

``` r
dta <- dta |> 
  dplyr::mutate(父母教育 = fct_relevel(父母教育, 
      c("國小以下", "初中", "高中", "專科", "大學以上")))
```

# 基本統計

``` r
#看看描述性統計（論文裡面常見的「表一」）
#程式報表3.3
gtsummary::tbl_summary(dta,
            statistic = list(all_continuous() ~ "{mean} ({sd})")) 
```

<div id="hizeafkxah" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hizeafkxah table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
&#10;#hizeafkxah thead, #hizeafkxah tbody, #hizeafkxah tfoot, #hizeafkxah tr, #hizeafkxah td, #hizeafkxah th {
  border-style: none;
}
&#10;#hizeafkxah p {
  margin: 0;
  padding: 0;
}
&#10;#hizeafkxah .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}
&#10;#hizeafkxah .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}
&#10;#hizeafkxah .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}
&#10;#hizeafkxah .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}
&#10;#hizeafkxah .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}
&#10;#hizeafkxah .gt_column_spanner_outer:first-child {
  padding-left: 0;
}
&#10;#hizeafkxah .gt_column_spanner_outer:last-child {
  padding-right: 0;
}
&#10;#hizeafkxah .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}
&#10;#hizeafkxah .gt_spanner_row {
  border-bottom-style: hidden;
}
&#10;#hizeafkxah .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}
&#10;#hizeafkxah .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}
&#10;#hizeafkxah .gt_from_md > :first-child {
  margin-top: 0;
}
&#10;#hizeafkxah .gt_from_md > :last-child {
  margin-bottom: 0;
}
&#10;#hizeafkxah .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}
&#10;#hizeafkxah .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#hizeafkxah .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}
&#10;#hizeafkxah .gt_row_group_first td {
  border-top-width: 2px;
}
&#10;#hizeafkxah .gt_row_group_first th {
  border-top-width: 2px;
}
&#10;#hizeafkxah .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#hizeafkxah .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_first_summary_row.thick {
  border-top-width: 2px;
}
&#10;#hizeafkxah .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#hizeafkxah .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}
&#10;#hizeafkxah .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#hizeafkxah .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#hizeafkxah .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#hizeafkxah .gt_left {
  text-align: left;
}
&#10;#hizeafkxah .gt_center {
  text-align: center;
}
&#10;#hizeafkxah .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}
&#10;#hizeafkxah .gt_font_normal {
  font-weight: normal;
}
&#10;#hizeafkxah .gt_font_bold {
  font-weight: bold;
}
&#10;#hizeafkxah .gt_font_italic {
  font-style: italic;
}
&#10;#hizeafkxah .gt_super {
  font-size: 65%;
}
&#10;#hizeafkxah .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}
&#10;#hizeafkxah .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}
&#10;#hizeafkxah .gt_indent_1 {
  text-indent: 5px;
}
&#10;#hizeafkxah .gt_indent_2 {
  text-indent: 10px;
}
&#10;#hizeafkxah .gt_indent_3 {
  text-indent: 15px;
}
&#10;#hizeafkxah .gt_indent_4 {
  text-indent: 20px;
}
&#10;#hizeafkxah .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    &#10;    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;N = 12,300&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>N = 12,300</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">國家</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    日本</td>
<td headers="stat_0" class="gt_row gt_center">3,420 (28%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    台灣</td>
<td headers="stat_0" class="gt_row gt_center">4,535 (37%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    韓國</td>
<td headers="stat_0" class="gt_row gt_center">4,345 (35%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">性別</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    女生</td>
<td headers="stat_0" class="gt_row gt_center">6,354 (52%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    男生</td>
<td headers="stat_0" class="gt_row gt_center">5,946 (48%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">父母教育</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    國小以下</td>
<td headers="stat_0" class="gt_row gt_center">128 (1.0%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    初中</td>
<td headers="stat_0" class="gt_row gt_center">618 (5.0%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    高中</td>
<td headers="stat_0" class="gt_row gt_center">4,907 (40%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    專科</td>
<td headers="stat_0" class="gt_row gt_center">1,798 (15%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    大學以上</td>
<td headers="stat_0" class="gt_row gt_center">4,849 (39%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">數學</td>
<td headers="stat_0" class="gt_row gt_center">606 (94)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">化學</td>
<td headers="stat_0" class="gt_row gt_center">573 (88)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">地科</td>
<td headers="stat_0" class="gt_row gt_center">562 (82)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">生物</td>
<td headers="stat_0" class="gt_row gt_center">565 (80)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">物理</td>
<td headers="stat_0" class="gt_row gt_center">569 (85)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">電腦</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    有</td>
<td headers="stat_0" class="gt_row gt_center">11,823 (96%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    無</td>
<td headers="stat_0" class="gt_row gt_center">477 (3.9%)</td></tr>
  </tbody>
  &#10;  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="2"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%); Mean (SD)</td>
    </tr>
  </tfoot>
</table>
</div>

``` r
#區分國家看看連續資料描述性統計
#程式報表3.4
dta |> dplyr::select(where(is.numeric), c('國家', '性別')) %>%
  gtsummary::tbl_summary(., by = 國家, 
                       statistic = list(all_continuous() ~ "{mean} ({sd})")) %>% add_p()
```

<div id="qnnlxrquxa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qnnlxrquxa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
&#10;#qnnlxrquxa thead, #qnnlxrquxa tbody, #qnnlxrquxa tfoot, #qnnlxrquxa tr, #qnnlxrquxa td, #qnnlxrquxa th {
  border-style: none;
}
&#10;#qnnlxrquxa p {
  margin: 0;
  padding: 0;
}
&#10;#qnnlxrquxa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}
&#10;#qnnlxrquxa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}
&#10;#qnnlxrquxa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}
&#10;#qnnlxrquxa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}
&#10;#qnnlxrquxa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}
&#10;#qnnlxrquxa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}
&#10;#qnnlxrquxa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}
&#10;#qnnlxrquxa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}
&#10;#qnnlxrquxa .gt_spanner_row {
  border-bottom-style: hidden;
}
&#10;#qnnlxrquxa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}
&#10;#qnnlxrquxa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}
&#10;#qnnlxrquxa .gt_from_md > :first-child {
  margin-top: 0;
}
&#10;#qnnlxrquxa .gt_from_md > :last-child {
  margin-bottom: 0;
}
&#10;#qnnlxrquxa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}
&#10;#qnnlxrquxa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qnnlxrquxa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}
&#10;#qnnlxrquxa .gt_row_group_first td {
  border-top-width: 2px;
}
&#10;#qnnlxrquxa .gt_row_group_first th {
  border-top-width: 2px;
}
&#10;#qnnlxrquxa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qnnlxrquxa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_first_summary_row.thick {
  border-top-width: 2px;
}
&#10;#qnnlxrquxa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qnnlxrquxa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}
&#10;#qnnlxrquxa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qnnlxrquxa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#qnnlxrquxa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#qnnlxrquxa .gt_left {
  text-align: left;
}
&#10;#qnnlxrquxa .gt_center {
  text-align: center;
}
&#10;#qnnlxrquxa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}
&#10;#qnnlxrquxa .gt_font_normal {
  font-weight: normal;
}
&#10;#qnnlxrquxa .gt_font_bold {
  font-weight: bold;
}
&#10;#qnnlxrquxa .gt_font_italic {
  font-style: italic;
}
&#10;#qnnlxrquxa .gt_super {
  font-size: 65%;
}
&#10;#qnnlxrquxa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}
&#10;#qnnlxrquxa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}
&#10;#qnnlxrquxa .gt_indent_1 {
  text-indent: 5px;
}
&#10;#qnnlxrquxa .gt_indent_2 {
  text-indent: 10px;
}
&#10;#qnnlxrquxa .gt_indent_3 {
  text-indent: 15px;
}
&#10;#qnnlxrquxa .gt_indent_4 {
  text-indent: 20px;
}
&#10;#qnnlxrquxa .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    &#10;    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;日本&lt;/strong&gt;, N = 3,420&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>日本</strong>, N = 3,420<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;台灣&lt;/strong&gt;, N = 4,535&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>台灣</strong>, N = 4,535<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;韓國&lt;/strong&gt;, N = 4,345&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>韓國</strong>, N = 4,345<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;p-value&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/span&gt;"><strong>p-value</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">數學</td>
<td headers="stat_1" class="gt_row gt_center">574 (83)</td>
<td headers="stat_2" class="gt_row gt_center">616 (102)</td>
<td headers="stat_3" class="gt_row gt_center">620 (86)</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">化學</td>
<td headers="stat_1" class="gt_row gt_center">564 (77)</td>
<td headers="stat_2" class="gt_row gt_center">595 (98)</td>
<td headers="stat_3" class="gt_row gt_center">557 (79)</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">地科</td>
<td headers="stat_1" class="gt_row gt_center">551 (81)</td>
<td headers="stat_2" class="gt_row gt_center">574 (80)</td>
<td headers="stat_3" class="gt_row gt_center">557 (83)</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">生物</td>
<td headers="stat_1" class="gt_row gt_center">564 (76)</td>
<td headers="stat_2" class="gt_row gt_center">563 (87)</td>
<td headers="stat_3" class="gt_row gt_center">568 (76)</td>
<td headers="p.value" class="gt_row gt_center">0.2</td></tr>
    <tr><td headers="label" class="gt_row gt_left">物理</td>
<td headers="stat_1" class="gt_row gt_center">563 (85)</td>
<td headers="stat_2" class="gt_row gt_center">559 (85)</td>
<td headers="stat_3" class="gt_row gt_center">585 (83)</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">性別</td>
<td headers="stat_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2" class="gt_row gt_center"><br /></td>
<td headers="stat_3" class="gt_row gt_center"><br /></td>
<td headers="p.value" class="gt_row gt_center">0.006</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    女生</td>
<td headers="stat_1" class="gt_row gt_center">1,800 (53%)</td>
<td headers="stat_2" class="gt_row gt_center">2,258 (50%)</td>
<td headers="stat_3" class="gt_row gt_center">2,296 (53%)</td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    男生</td>
<td headers="stat_1" class="gt_row gt_center">1,620 (47%)</td>
<td headers="stat_2" class="gt_row gt_center">2,277 (50%)</td>
<td headers="stat_3" class="gt_row gt_center">2,049 (47%)</td>
<td headers="p.value" class="gt_row gt_center"><br /></td></tr>
  </tbody>
  &#10;  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Mean (SD); n (%)</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="5"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> Kruskal-Wallis rank sum test; Pearson’s Chi-squared test</td>
    </tr>
  </tfoot>
</table>
</div>

``` r
#區分國家與性別看看連續資料描述性統計
#程式報表3.5
dta |> dplyr::select(where(is.numeric), c('國家', '性別')) %>%
  gtsummary::tbl_strata(strata = 國家, 
                        .tbl_fun =
                          ~ .x %>%
  tbl_summary(by = 性別,
              statistic = list(all_continuous() ~ "{mean} ({sd})"))) 
```

<div id="gaevhrnget" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gaevhrnget table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
&#10;#gaevhrnget thead, #gaevhrnget tbody, #gaevhrnget tfoot, #gaevhrnget tr, #gaevhrnget td, #gaevhrnget th {
  border-style: none;
}
&#10;#gaevhrnget p {
  margin: 0;
  padding: 0;
}
&#10;#gaevhrnget .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}
&#10;#gaevhrnget .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}
&#10;#gaevhrnget .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}
&#10;#gaevhrnget .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}
&#10;#gaevhrnget .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}
&#10;#gaevhrnget .gt_column_spanner_outer:first-child {
  padding-left: 0;
}
&#10;#gaevhrnget .gt_column_spanner_outer:last-child {
  padding-right: 0;
}
&#10;#gaevhrnget .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}
&#10;#gaevhrnget .gt_spanner_row {
  border-bottom-style: hidden;
}
&#10;#gaevhrnget .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}
&#10;#gaevhrnget .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}
&#10;#gaevhrnget .gt_from_md > :first-child {
  margin-top: 0;
}
&#10;#gaevhrnget .gt_from_md > :last-child {
  margin-bottom: 0;
}
&#10;#gaevhrnget .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}
&#10;#gaevhrnget .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#gaevhrnget .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}
&#10;#gaevhrnget .gt_row_group_first td {
  border-top-width: 2px;
}
&#10;#gaevhrnget .gt_row_group_first th {
  border-top-width: 2px;
}
&#10;#gaevhrnget .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#gaevhrnget .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_first_summary_row.thick {
  border-top-width: 2px;
}
&#10;#gaevhrnget .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#gaevhrnget .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}
&#10;#gaevhrnget .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#gaevhrnget .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#gaevhrnget .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#gaevhrnget .gt_left {
  text-align: left;
}
&#10;#gaevhrnget .gt_center {
  text-align: center;
}
&#10;#gaevhrnget .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}
&#10;#gaevhrnget .gt_font_normal {
  font-weight: normal;
}
&#10;#gaevhrnget .gt_font_bold {
  font-weight: bold;
}
&#10;#gaevhrnget .gt_font_italic {
  font-style: italic;
}
&#10;#gaevhrnget .gt_super {
  font-size: 65%;
}
&#10;#gaevhrnget .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}
&#10;#gaevhrnget .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}
&#10;#gaevhrnget .gt_indent_1 {
  text-indent: 5px;
}
&#10;#gaevhrnget .gt_indent_2 {
  text-indent: 10px;
}
&#10;#gaevhrnget .gt_indent_3 {
  text-indent: 15px;
}
&#10;#gaevhrnget .gt_indent_4 {
  text-indent: 20px;
}
&#10;#gaevhrnget .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    &#10;    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="&lt;strong&gt;日本&lt;/strong&gt;">
        <span class="gt_column_spanner"><strong>日本</strong></span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="&lt;strong&gt;台灣&lt;/strong&gt;">
        <span class="gt_column_spanner"><strong>台灣</strong></span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="&lt;strong&gt;韓國&lt;/strong&gt;">
        <span class="gt_column_spanner"><strong>韓國</strong></span>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;女生&lt;/strong&gt;, N = 1,800&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>女生</strong>, N = 1,800<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;男生&lt;/strong&gt;, N = 1,620&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>男生</strong>, N = 1,620<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;女生&lt;/strong&gt;, N = 2,258&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>女生</strong>, N = 2,258<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;男生&lt;/strong&gt;, N = 2,277&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>男生</strong>, N = 2,277<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;女生&lt;/strong&gt;, N = 2,296&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>女生</strong>, N = 2,296<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;男生&lt;/strong&gt;, N = 2,049&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>男生</strong>, N = 2,049<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">數學</td>
<td headers="stat_1_1" class="gt_row gt_center">569 (80)</td>
<td headers="stat_2_1" class="gt_row gt_center">579 (87)</td>
<td headers="stat_1_2" class="gt_row gt_center">619 (97)</td>
<td headers="stat_2_2" class="gt_row gt_center">614 (107)</td>
<td headers="stat_1_3" class="gt_row gt_center">617 (85)</td>
<td headers="stat_2_3" class="gt_row gt_center">624 (88)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">化學</td>
<td headers="stat_1_1" class="gt_row gt_center">561 (75)</td>
<td headers="stat_2_1" class="gt_row gt_center">567 (79)</td>
<td headers="stat_1_2" class="gt_row gt_center">598 (94)</td>
<td headers="stat_2_2" class="gt_row gt_center">592 (101)</td>
<td headers="stat_1_3" class="gt_row gt_center">556 (76)</td>
<td headers="stat_2_3" class="gt_row gt_center">558 (82)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">地科</td>
<td headers="stat_1_1" class="gt_row gt_center">542 (79)</td>
<td headers="stat_2_1" class="gt_row gt_center">562 (82)</td>
<td headers="stat_1_2" class="gt_row gt_center">567 (76)</td>
<td headers="stat_2_2" class="gt_row gt_center">580 (84)</td>
<td headers="stat_1_3" class="gt_row gt_center">551 (80)</td>
<td headers="stat_2_3" class="gt_row gt_center">565 (87)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">生物</td>
<td headers="stat_1_1" class="gt_row gt_center">563 (75)</td>
<td headers="stat_2_1" class="gt_row gt_center">565 (78)</td>
<td headers="stat_1_2" class="gt_row gt_center">564 (82)</td>
<td headers="stat_2_2" class="gt_row gt_center">562 (92)</td>
<td headers="stat_1_3" class="gt_row gt_center">566 (74)</td>
<td headers="stat_2_3" class="gt_row gt_center">569 (79)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">物理</td>
<td headers="stat_1_1" class="gt_row gt_center">558 (82)</td>
<td headers="stat_2_1" class="gt_row gt_center">569 (87)</td>
<td headers="stat_1_2" class="gt_row gt_center">552 (82)</td>
<td headers="stat_2_2" class="gt_row gt_center">565 (87)</td>
<td headers="stat_1_3" class="gt_row gt_center">583 (81)</td>
<td headers="stat_2_3" class="gt_row gt_center">587 (86)</td></tr>
  </tbody>
  &#10;  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="7"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Mean (SD)</td>
    </tr>
  </tfoot>
</table>
</div>

\#連續變項

``` r
#看看連續資料（數學分數）的直方圖
#圖3.1
ggplot(data=dta, 
       aes(x = 數學, after_stat(density))) +
  geom_histogram(binwidth = function(x) 2 * IQR(x) / (length(x)^(1/3)),
                 col='black', fill='gray90')+
  labs(x = '數學分數', 
       y = '機率密度')
```

<img src="ch03_files/figure-gfm/fig3_1-1.png" style="display: block; margin: auto;" />

``` r
#看看連續資料（五科分數）的直方圖
#圖3.2
dta |> dplyr::select(where(is.numeric)) |>
  tidyr::pivot_longer(everything()) |>
  dplyr::mutate(name = reorder(name, value, mean)) |>
  ggplot() +
  aes(x = value, after_stat(density)) +
  facet_wrap(~ name, scales = 'free_y', ncol=1) +
  geom_histogram(binwidth = function(x) 2 * IQR(x) / (length(x)^(1/3)),
                 fill='gray90', col='black')+
  labs(x = '分數', 
       y = '機率密度',
       title="五科分數分配圖(不分國家)")
```

<img src="ch03_files/figure-gfm/fig3_2-1.png" style="display: block; margin: auto;" />

## 連續變項間關係

``` r
#數學與物理分數相關
#程式報表3.6前
with(dta, cor(數學, 物理)) |> round(3)
```

    [1] 0.728

``` r
#所有學科分數相關
#程式報表3.6後
dta |> dplyr::select(where(is.numeric)) |>
  cor() |> round(3)
```

<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
數學
</th>
<th style="text-align:right;">
化學
</th>
<th style="text-align:right;">
地科
</th>
<th style="text-align:right;">
生物
</th>
<th style="text-align:right;">
物理
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
數學
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.730
</td>
<td style="text-align:right;">
0.691
</td>
<td style="text-align:right;">
0.709
</td>
<td style="text-align:right;">
0.728
</td>
</tr>
<tr>
<td style="text-align:left;">
化學
</td>
<td style="text-align:right;">
0.730
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.864
</td>
<td style="text-align:right;">
0.871
</td>
<td style="text-align:right;">
0.860
</td>
</tr>
<tr>
<td style="text-align:left;">
地科
</td>
<td style="text-align:right;">
0.691
</td>
<td style="text-align:right;">
0.864
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.877
</td>
<td style="text-align:right;">
0.856
</td>
</tr>
<tr>
<td style="text-align:left;">
生物
</td>
<td style="text-align:right;">
0.709
</td>
<td style="text-align:right;">
0.871
</td>
<td style="text-align:right;">
0.877
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.898
</td>
</tr>
<tr>
<td style="text-align:left;">
物理
</td>
<td style="text-align:right;">
0.728
</td>
<td style="text-align:right;">
0.860
</td>
<td style="text-align:right;">
0.856
</td>
<td style="text-align:right;">
0.898
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
</tbody>
</table>

``` r
#兩兩變項畫散佈圖
#圖3.3
dta |>
  dplyr::select_if(is.numeric) |> 
  as.tibble() |>
  GGally::ggpairs(data = _, axisLabels= 'internal', title= '變項間關聯')
```

<img src="ch03_files/figure-gfm/fig3_3-1.png" style="display: block; margin: auto;" />

## 檢定相關

``` r
#檢定相關是否顯著，也可以看到信賴區間
#程式報表3.7
dta |> 
  dplyr::select(where(is.numeric)) |>
  cor.test( ~ 數學 + 物理, data = _)
```


        Pearson's product-moment correlation

    data:  數學 and 物理
    t = 118, df = 12298, p-value <2e-16
    alternative hypothesis: true correlation is not equal to 0
    95 percent confidence interval:
     0.7196 0.7362
    sample estimates:
      cor 
    0.728 

``` r
#以 Hmist　一次檢定所有相關
#程式報表3.8
dta4 <- dta |> 
  dplyr::select(where(is.numeric))
Hmisc::rcorr(as.matrix(dta4), type="pearson") 
```

         數學 化學 地科 生物 物理
    數學 1.00 0.73 0.69 0.71 0.73
    化學 0.73 1.00 0.86 0.87 0.86
    地科 0.69 0.86 1.00 0.88 0.86
    生物 0.71 0.87 0.88 1.00 0.90
    物理 0.73 0.86 0.86 0.90 1.00

    n= 12300 


    P
         數學 化學 地科 生物 物理
    數學       0    0    0    0  
    化學  0         0    0    0  
    地科  0    0         0    0  
    生物  0    0    0         0  
    物理  0    0    0    0       

``` r
#檢驗數學與物理、數學與生物何者相關高
#程式報表3.9
cocor::cocor(~ 數學 + 物理 | 數學 + 生物, dta)
```


      Results of a comparison of two overlapping correlations based on dependent groups

    Comparison between r.jk (數學, 物理) = 0.728 and r.jh (數學, 生物) = 0.7092
    Difference: r.jk - r.jh = 0.0189
    Related correlation: r.kh = 0.8975
    Data: dta: j = 數學, k = 物理, h = 生物
    Group size: n = 12300
    Null hypothesis: r.jk is equal to r.jh
    Alternative hypothesis: r.jk is not equal to r.jh (two-sided)
    Alpha: 0.05

    pearson1898: Pearson and Filon's z (1898)
      z = 6.8293, p-value = 0.0000
      Null hypothesis rejected

    hotelling1940: Hotelling's t (1940)
      t = 6.8706, df = 12297, p-value = 0.0000
      Null hypothesis rejected

    williams1959: Williams' t (1959)
      t = 6.8598, df = 12297, p-value = 0.0000
      Null hypothesis rejected

    olkin1967: Olkin's z (1967)
      z = 6.8293, p-value = 0.0000
      Null hypothesis rejected

    dunn1969: Dunn and Clark's z (1969)
      z = 6.8537, p-value = 0.0000
      Null hypothesis rejected

    hendrickson1970: Hendrickson, Stanley, and Hills' (1970) modification of Williams' t (1959)
      t = 6.8706, df = 12297, p-value = 0.0000
      Null hypothesis rejected

    steiger1980: Steiger's (1980) modification of Dunn and Clark's z (1969) using average correlations
      z = 6.8489, p-value = 0.0000
      Null hypothesis rejected

    meng1992: Meng, Rosenthal, and Rubin's z (1992)
      z = 6.8483, p-value = 0.0000
      Null hypothesis rejected
      95% confidence interval for r.jk - r.jh: 0.0279 0.0503
      Null hypothesis rejected (Interval does not include 0)

    hittner2003: Hittner, May, and Silver's (2003) modification of Dunn and Clark's z (1969) using a backtransformed average Fisher's (1921) Z procedure
      z = 6.8477, p-value = 0.0000
      Null hypothesis rejected

    zou2007: Zou's (2007) confidence interval
      95% confidence interval for r.jk - r.jh: 0.0135 0.0243
      Null hypothesis rejected (Interval does not include 0)

``` r
#檢驗數學與物理、地科與生物何者相關高
#程式報表3.10
cocor::cocor(~ 數學 + 物理 | 地科 + 生物, dta)
```


      Results of a comparison of two nonoverlapping correlations based on dependent groups

    Comparison between r.jk (數學, 物理) = 0.728 and r.hm (地科, 生物) = 0.8766
    Difference: r.jk - r.hm = -0.1485
    Related correlations: r.jh = 0.6907, r.jm = 0.7092, r.kh = 0.8556, r.km = 0.8975
    Data: dta: j = 數學, k = 物理, h = 地科, m = 生物
    Group size: n = 12300
    Null hypothesis: r.jk is equal to r.hm
    Alternative hypothesis: r.jk is not equal to r.hm (two-sided)
    Alpha: 0.05

    pearson1898: Pearson and Filon's z (1898)
      z = -37.0484, p-value = 0.0000
      Null hypothesis rejected

    dunn1969: Dunn and Clark's z (1969)
      z = -42.5188, p-value = 0.0000
      Null hypothesis rejected

    steiger1980: Steiger's (1980) modification of Dunn and Clark's z (1969) using average correlations
      z = -42.0886, p-value = 0.0000
      Null hypothesis rejected

    raghunathan1996: Raghunathan, Rosenthal, and Rubin's (1996) modification of Pearson and Filon's z (1898)
      z = -42.5188, p-value = 0.0000
      Null hypothesis rejected

    silver2004: Silver, Hittner, and May's (2004) modification of Dunn and Clark's z (1969) using a backtransformed average Fisher's (1921) Z procedure
      z = -41.8351, p-value = 0.0000
      Null hypothesis rejected

    zou2007: Zou's (2007) confidence interval
      95% confidence interval for r.jk - r.hm: -0.1565 -0.1408
      Null hypothesis rejected (Interval does not include 0)

## 類別變項分配圖

``` r
#單一類別變項分布圖
#圖3.4
with(dta, table(父母教育)) |> 
    prop.table() |>
    as.data.frame() |>
ggplot()+
  aes(y=Freq,x=父母教育) + 
  geom_bar(stat = "identity",width = .1) + 
  scale_y_continuous(labels=scales::percent) +
  scale_fill_grey()+
  coord_flip()+
  labs(y="百分比") +
  theme(legend.position="none")
```

<img src="ch03_files/figure-gfm/fig3_4-1.png" style="display: block; margin: auto;" />

``` r
#看看兩個類別資料間關聯（兩類別變項的列聯表）
#程式報表3.11
dta |> dplyr::select(c('國家', '父母教育')) %>%
  gtsummary::tbl_cross(row=國家, col=父母教育, percent="cell") %>%   
  add_p(source_note = TRUE)
```

<div id="dqkbdxvtzt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dqkbdxvtzt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
&#10;#dqkbdxvtzt thead, #dqkbdxvtzt tbody, #dqkbdxvtzt tfoot, #dqkbdxvtzt tr, #dqkbdxvtzt td, #dqkbdxvtzt th {
  border-style: none;
}
&#10;#dqkbdxvtzt p {
  margin: 0;
  padding: 0;
}
&#10;#dqkbdxvtzt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}
&#10;#dqkbdxvtzt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}
&#10;#dqkbdxvtzt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}
&#10;#dqkbdxvtzt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}
&#10;#dqkbdxvtzt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}
&#10;#dqkbdxvtzt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}
&#10;#dqkbdxvtzt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}
&#10;#dqkbdxvtzt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}
&#10;#dqkbdxvtzt .gt_spanner_row {
  border-bottom-style: hidden;
}
&#10;#dqkbdxvtzt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}
&#10;#dqkbdxvtzt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}
&#10;#dqkbdxvtzt .gt_from_md > :first-child {
  margin-top: 0;
}
&#10;#dqkbdxvtzt .gt_from_md > :last-child {
  margin-bottom: 0;
}
&#10;#dqkbdxvtzt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}
&#10;#dqkbdxvtzt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#dqkbdxvtzt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}
&#10;#dqkbdxvtzt .gt_row_group_first td {
  border-top-width: 2px;
}
&#10;#dqkbdxvtzt .gt_row_group_first th {
  border-top-width: 2px;
}
&#10;#dqkbdxvtzt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#dqkbdxvtzt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_first_summary_row.thick {
  border-top-width: 2px;
}
&#10;#dqkbdxvtzt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#dqkbdxvtzt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}
&#10;#dqkbdxvtzt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#dqkbdxvtzt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}
&#10;#dqkbdxvtzt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}
&#10;#dqkbdxvtzt .gt_left {
  text-align: left;
}
&#10;#dqkbdxvtzt .gt_center {
  text-align: center;
}
&#10;#dqkbdxvtzt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}
&#10;#dqkbdxvtzt .gt_font_normal {
  font-weight: normal;
}
&#10;#dqkbdxvtzt .gt_font_bold {
  font-weight: bold;
}
&#10;#dqkbdxvtzt .gt_font_italic {
  font-style: italic;
}
&#10;#dqkbdxvtzt .gt_super {
  font-size: 65%;
}
&#10;#dqkbdxvtzt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}
&#10;#dqkbdxvtzt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}
&#10;#dqkbdxvtzt .gt_indent_1 {
  text-indent: 5px;
}
&#10;#dqkbdxvtzt .gt_indent_2 {
  text-indent: 10px;
}
&#10;#dqkbdxvtzt .gt_indent_3 {
  text-indent: 15px;
}
&#10;#dqkbdxvtzt .gt_indent_4 {
  text-indent: 20px;
}
&#10;#dqkbdxvtzt .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    &#10;    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id=""></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="5" scope="colgroup" id="父母教育">
        <span class="gt_column_spanner">父母教育</span>
      </th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="2" colspan="1" scope="col" id="Total">Total</th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="國小以下">國小以下</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="初中">初中</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="高中">高中</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="專科">專科</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="大學以上">大學以上</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">國家</td>
<td headers="stat_1" class="gt_row gt_center"><br /></td>
<td headers="stat_2" class="gt_row gt_center"><br /></td>
<td headers="stat_3" class="gt_row gt_center"><br /></td>
<td headers="stat_4" class="gt_row gt_center"><br /></td>
<td headers="stat_5" class="gt_row gt_center"><br /></td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    日本</td>
<td headers="stat_1" class="gt_row gt_center">8 (&lt;0.1%)</td>
<td headers="stat_2" class="gt_row gt_center">78 (0.6%)</td>
<td headers="stat_3" class="gt_row gt_center">1,140 (9.3%)</td>
<td headers="stat_4" class="gt_row gt_center">771 (6.3%)</td>
<td headers="stat_5" class="gt_row gt_center">1,423 (12%)</td>
<td headers="stat_0" class="gt_row gt_center">3,420 (28%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    台灣</td>
<td headers="stat_1" class="gt_row gt_center">85 (0.7%)</td>
<td headers="stat_2" class="gt_row gt_center">463 (3.8%)</td>
<td headers="stat_3" class="gt_row gt_center">2,053 (17%)</td>
<td headers="stat_4" class="gt_row gt_center">677 (5.5%)</td>
<td headers="stat_5" class="gt_row gt_center">1,257 (10%)</td>
<td headers="stat_0" class="gt_row gt_center">4,535 (37%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    韓國</td>
<td headers="stat_1" class="gt_row gt_center">35 (0.3%)</td>
<td headers="stat_2" class="gt_row gt_center">77 (0.6%)</td>
<td headers="stat_3" class="gt_row gt_center">1,714 (14%)</td>
<td headers="stat_4" class="gt_row gt_center">350 (2.8%)</td>
<td headers="stat_5" class="gt_row gt_center">2,169 (18%)</td>
<td headers="stat_0" class="gt_row gt_center">4,345 (35%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Total</td>
<td headers="stat_1" class="gt_row gt_center">128 (1.0%)</td>
<td headers="stat_2" class="gt_row gt_center">618 (5.0%)</td>
<td headers="stat_3" class="gt_row gt_center">4,907 (40%)</td>
<td headers="stat_4" class="gt_row gt_center">1,798 (15%)</td>
<td headers="stat_5" class="gt_row gt_center">4,849 (39%)</td>
<td headers="stat_0" class="gt_row gt_center">12,300 (100%)</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="7">Pearson’s Chi-squared test, p&lt;0.001</td>
    </tr>
  </tfoot>
  &#10;</table>
</div>

``` r
#兩類別變項卡方檢定
#程式報表3.12前
with(dta, table(國家, 父母教育)) |> 
  chisq.test(simulate.p.value = TRUE)
```


        Pearson's Chi-squared test with simulated p-value (based on 2000
        replicates)

    data:  with(dta, table(國家, 父母教育))
    X-squared = 1068, df = NA, p-value = 5e-04

``` r
#兩類別變項間關聯（Cramer's V）
#程式報表3.12後
with(dta, table(國家, 父母教育)) |> 
  chisq.test(simulate.p.value = TRUE) |> 
  cramersv()
```

    [1] 0.2083

``` r
#看看兩個類別資料的分配圖（欄總和為100%）
#程式報表3.13
with(dta, table(父母教育, 國家)) |> 
  prop.table(2) |> 
  round(3)
```

<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
日本
</th>
<th style="text-align:right;">
台灣
</th>
<th style="text-align:right;">
韓國
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
國小以下
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.008
</td>
</tr>
<tr>
<td style="text-align:left;">
初中
</td>
<td style="text-align:right;">
0.023
</td>
<td style="text-align:right;">
0.102
</td>
<td style="text-align:right;">
0.018
</td>
</tr>
<tr>
<td style="text-align:left;">
高中
</td>
<td style="text-align:right;">
0.333
</td>
<td style="text-align:right;">
0.453
</td>
<td style="text-align:right;">
0.394
</td>
</tr>
<tr>
<td style="text-align:left;">
專科
</td>
<td style="text-align:right;">
0.225
</td>
<td style="text-align:right;">
0.149
</td>
<td style="text-align:right;">
0.081
</td>
</tr>
<tr>
<td style="text-align:left;">
大學以上
</td>
<td style="text-align:right;">
0.416
</td>
<td style="text-align:right;">
0.277
</td>
<td style="text-align:right;">
0.499
</td>
</tr>
</tbody>
</table>

``` r
#先計算不同國家父母教育百分比，再以ggplot繪圖 
#圖3.5
with(dta, table(父母教育, 國家)) |> 
  prop.table(2) |> 
  as.data.frame() |>
  ggplot()+
  aes(y=Freq, x=父母教育, color=國家, group=國家)+
  geom_point()+
  geom_line()+
  scale_color_grey()+
  labs(y="百分比")+
  theme(legend.position="top")
```

<img src="ch03_files/figure-gfm/fig3_5-1.png" style="display: block; margin: auto;" />

``` r
#也可以不用先算，直接讓 ggplot 算
#圖3.6
ggplot(dta, 
       aes(x=父母教育, group = 國家 )) + 
  geom_bar(aes(y=after_stat(prop), 
               fill = factor(after_stat(x))),
           width = .1) + 
  scale_y_continuous(labels=scales::percent) +
  scale_fill_grey()+
  coord_flip()+
  labs(y="百分比") +
  facet_wrap(vars(國家), ncol=1)+
  theme(legend.position="none")
```

<img src="ch03_files/figure-gfm/fig3_6-1.png" style="display: block; margin: auto;" />

## 連續變項與類別變項間的關係

``` r
##兩個類別變項與一個連續變項
#看看不同國家以及家裡有無電腦下，學生數學分數直方圖
#圖3.7
ggplot(dta, aes(x=數學, color=電腦)) +
  geom_density() +
  scale_color_grey()+
  facet_wrap(vars(國家))+
  labs(x = "數學分數",
       y = "機率密度")+
  theme(legend.position='top')
```

<img src="ch03_files/figure-gfm/fig3_7-1.png" style="display: block; margin: auto;" />

``` r
#也可用實徵累積機率密度函數圖比較
#圖3.8
ggplot(dta, aes(x=數學, color=電腦)) +
  stat_ecdf() +
  scale_color_grey(end=.7)+
  facet_wrap(vars(國家))+
  labs(x = "數學分數",
       y = "累積機率密度")+
  theme(legend.position='top')
```

<img src="ch03_files/figure-gfm/fig3_8-1.png" style="display: block; margin: auto;" />

``` r
#看看有無電腦的學生數學平均與數標差
#程式報表3.14
aggregate(數學 ~ 電腦, data = dta, FUN = mean)
```

<table>
<thead>
<tr>
<th style="text-align:left;">
電腦
</th>
<th style="text-align:right;">
數學
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
有
</td>
<td style="text-align:right;">
608.9
</td>
</tr>
<tr>
<td style="text-align:left;">
無
</td>
<td style="text-align:right;">
532.3
</td>
</tr>
</tbody>
</table>

``` r
aggregate(數學 ~ 電腦, data = dta, FUN = sd)
```

<table>
<thead>
<tr>
<th style="text-align:left;">
電腦
</th>
<th style="text-align:right;">
數學
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
有
</td>
<td style="text-align:right;">
92.66
</td>
</tr>
<tr>
<td style="text-align:left;">
無
</td>
<td style="text-align:right;">
92.78
</td>
</tr>
</tbody>
</table>

``` r
#以盒鬚圖看不同國家學生的差異
#圖3.9
ggplot(dta, aes(y=數學, x=父母教育, col=性別)) +
  geom_boxplot() +
  scale_color_grey()+
  facet_grid(. ~ 國家)+
  labs(x = "數學分數",
       y = "機率密度")+
  theme(legend.position='top')
```

<img src="ch03_files/figure-gfm/fig3_9-1.png" style="display: block; margin: auto;" />

``` r
#看看不同國家間，物理與數學間的關係是否類似
#圖3.10
ggplot(dta, aes(x=數學, y=物理, col=性別)) +
  geom_point(pch = '.', alpha = .8)+
  stat_smooth(method='lm',
              formula = y ~ x,
              se =FALSE,
              linewidth = .5) +
  scale_color_grey()+
  facet_wrap(vars(國家), nrow=1)+
  labs(x = "數學分數",
       y = "物理分數")+
  theme(legend.position='top')
```

<img src="ch03_files/figure-gfm/fig3_10-1.png" style="display: block; margin: auto;" />

``` r
#在圖中加入了誤差
#圖3.11
ggplot(dta,
       aes(x=父母教育, y = 數學, color=電腦))+
  stat_summary(fun.data = "mean_cl_boot", 
               position=position_dodge(.5))+
  facet_grid(性別 ~ 國家)+
  scale_color_grey(end=.7)+
  theme(legend.position='top')
```

<img src="ch03_files/figure-gfm/fig3_11-1.png" style="display: block; margin: auto;" />

``` r
##連續變項與兩個類別變項間的關係
#看看不同國家、不同性別不同父母教育的學生數學平均與對應的平均數標準誤
#程式報表3.15
dta |> dplyr::group_by(國家, 父母教育, 性別) |>
  dplyr::summarize(數學平均 = mean(數學),
                   數學分數標準誤 = sd(數學)/ sqrt(n())) |>
  dplyr::ungroup() |>
  dplyr::filter(國家 == '台灣')
```

<table>
<thead>
<tr>
<th style="text-align:left;">
國家
</th>
<th style="text-align:left;">
父母教育
</th>
<th style="text-align:left;">
性別
</th>
<th style="text-align:right;">
數學平均
</th>
<th style="text-align:right;">
數學分數標準誤
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
國小以下
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:right;">
534.7
</td>
<td style="text-align:right;">
16.861
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
國小以下
</td>
<td style="text-align:left;">
男生
</td>
<td style="text-align:right;">
525.6
</td>
<td style="text-align:right;">
19.402
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
初中
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:right;">
553.9
</td>
<td style="text-align:right;">
6.827
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
初中
</td>
<td style="text-align:left;">
男生
</td>
<td style="text-align:right;">
557.8
</td>
<td style="text-align:right;">
6.382
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
高中
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:right;">
601.9
</td>
<td style="text-align:right;">
2.818
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
高中
</td>
<td style="text-align:left;">
男生
</td>
<td style="text-align:right;">
593.2
</td>
<td style="text-align:right;">
3.269
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
專科
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:right;">
639.4
</td>
<td style="text-align:right;">
4.489
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
專科
</td>
<td style="text-align:left;">
男生
</td>
<td style="text-align:right;">
649.9
</td>
<td style="text-align:right;">
4.835
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
大學以上
</td>
<td style="text-align:left;">
女生
</td>
<td style="text-align:right;">
664.5
</td>
<td style="text-align:right;">
3.504
</td>
</tr>
<tr>
<td style="text-align:left;">
台灣
</td>
<td style="text-align:left;">
大學以上
</td>
<td style="text-align:left;">
男生
</td>
<td style="text-align:right;">
656.2
</td>
<td style="text-align:right;">
3.843
</td>
</tr>
</tbody>
</table>
